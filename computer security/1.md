# Classical cryptography techiniques

### Basic Terminologies:
- **Plaintext**: The original message that needs to be encrypted.
- **Ciphertext**: The encrypted message that results from the encryption of the plaintext. 
- **Cipher**: refers to the algorithm used for encryption and decryption.
- **Key**: A piece of information used in conjunction with the cipher to encrypt and decrypt messages.
- **Encryption or Encipher**: The process of converting plaintext into ciphertext using an algorithm and a key.
- **Decryption or decipher**: The process of converting ciphertext back into plaintext using an algorithm and a key.
- **Cryptography**: The study and practice of techniques for encrypting and decrypting information to ensure its confidentiality, integrity, and authenticity.
- **Cryptanalysis**: The study and practice of analyzing and breaking cryptographic systems to uncover hidden information without knowledge of the key. (Method of deciphering without the knowing the key. Brute force attack)
- **Cryptology**: The study of both cryptography and cryptanalysis.


### Types of Cryptography Techniques:
#### A. Types based on Operation:
1. Substitution: replacing elements of the plaintext with other elements.
2. Transposition: rearranging the elements of the plaintext.
3. Product: combining substitution and transposition techniques.

#### B. Types based on Number of Keys:
1. Single key (Pritvate/Symmetric Key): uses the same key for both encryption and decryption.
2. Two keys (Public/Asymmetric Key): uses a pair of keys - a public key for encryption and a private key for decryption.

#### C. Types based on the Size of Plaintext:
1. Block: (Fixed size chunks) processes the plaintext in fixed-size blocks. Size defined by the user?
2. Stream

### Symmetric Key Encryption:
- Processing input in two ways:
  1. Block Cipher: processes fixed-size blocks of plaintext.
    - Types of Block Ciphers:
        - Transpositon Cipher: rearranges the positions of characters in the plaintext.
        - Substitution Cipher: replaces each character in the plaintext with another character.
            - Polyalphabetic substitution: uses multiple substitution alphabets to enhance security.
            - Monoalphabetic substitution: uses a single substitution alphabet for the entire message.
            - Polygram substitution: replaces groups of characters with other groups of characters.
            - Homophonic substitution: uses multiple ciphertext symbols for a single plaintext symbol to obscure frequency analysis.
  2. Stream Cipher: processes plaintext one bit or byte at a time, often used for real-time data.

### Asymmetric Key Encryption:
1. RSA Public Key: based on the mathematical properties of large prime numbers.
2. Elliptic Curve Cryptography (ECC): based on the algebraic structure of elliptic curves over finite fields.
3. Diffie-Hellman Key Exchange: a method for securely exchanging cryptographic keys over a public channel.

### Block Cipher:
- It transforms a fixed length block of plaintext data into a block of ciphertext data of the same length with the help of a secret key.
        ![alt text](image.png)
- The fixed length is called as block size. Many block ciphers prefer block sizes of 64 bits for example AES, DES, 3DES, Blowfish etc.
   

### Substitution Cipher Example:
- Under a substitution cipher, unit maybe a single letter or pairs of letters or triplets of letters and so on, which are substituted with cipher text for a plaintext. 
- Monoalphabetic substitution cipher is a type of substitution cipher where each letter in the plaintext is replaced with a corresponding letter in the ciphertext alphabet.
    - For example, using the following substitution alphabet:
        Plaintext: COLLEGE (K = 1)
        Ciphertext: DPMMHJF
- Polyalphabetic substitution cipher uses multiple substitution alphabets to enhance security.
    - For example, using two different substitution alphabets:
        Plaintext: COLLEGE
        Ciphertext: DQMMHJF (using first alphabet)
        Ciphertext: EPNNIGK (using second alphabet)
- Polygram substitution cipher replaces groups of characters with other groups of characters using a predefined substitution table.
    - For example, using bigrams (pairs of letters):
        Plaintext: CO LL EG E
        Ciphertext: XY AB CD EF (using a predefined bigram substitution table)
- Homophonic substitution cipher uses multiple ciphertext symbols for a single plaintext symbol to obscure frequency analysis.
    - For example, the letter 'E' in plaintext could be represented by multiple symbols in ciphertext, such as 'X', 'Y', or 'Z', based on a predefined mapping.
    Plaintext: E
    Ciphertext: XXXXXXXX

## Monoalphabetic Substitution:
- C = l(m) = m + k mod s
    - C = Ciphertext letter
    - l = Encryption function
    - m = Plaintext letter
    - k = Key (shift value)
    - s = Size of the alphabet (e.g., 26 for English alphabet)
- The most common monoalphabetic substitution cipher is the Caesar cipher, which shifts each letter in the plaintext by a fixed number of positions down the alphabet.
    - For example, with a shift of 3:
        - Plaintext: A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
        - Ciphertext: D E F G H I J K L M N O P Q R S T U V W X Y Z A B C

#### Classical Substitution Cipher:
- Letters of plaintext is replaced by letters, numbers or symbols.
- Caesar Cipher is a popular example of classical substitution cipher.
- Julius Caesar used this cipher to communicate with his generals.
- In this cipher, each letter in the plaintext has an index. For example, A=0, B=1, C=2, ..., Z=25.
- C = E(P) = P + k mod 26 and P = D(C) = C - k mod 26
    - C = Ciphertext letter
    - E = Encryption function
    - P = Plaintext letter
    - k = Key (shift value)
    - 26 = Size of the alphabet
- Questions: 
    - Encrypt the plaintext "CAT" with shift value 3.
        - Plaintext: C A T
        C: 2 + 3 = 5 mod 26 -> F (26|5)
        A: 0 + 3 = 3 mod 26 -> D
        T: 19 + 3 = 22 mod 26 -> W
        - Ciphertext: F D W
    - Encrypt the plaintext "XYZ" with shift value 3.
        - Plaintext: X Y Z
        X: 23 + 3 = 26 mod 26 -> 0 -> A
        Y: 24 + 3 = 27 mod 26 -> 1 -> B
        Z: 25 + 3 = 28 mod 26 -> 2 -> C
        - Ciphertext: A B C
    - Decrypt the ciphertext "KHOOR" with shift value 3.
        - Ciphertext: K H O O R
        - Plaintext: H E L L O
    - Decrypt the ciphertext "CDE" with shift value 3.
        - Ciphertext: C D E
        C: 2 - 3 = -1 mod 26 -> 25 -> Z
        D: 3 - 3 = 0 mod 26 -> A
        E: 4 - 3 = 1 mod 26 -> B
        - Plaintext: Z A B
    - Decrypt the ciphertext "ABC" with shift value 3.
        - Ciphertext: A B C
        - Plaintext: X Y Z
    - Decrypt the ciphertext "WKLV" without shift value. (Cryptanalysis example)
        - Ciphertext: W K L V
        Shift value 1: V J K U
        Shift value 2: U I J T
        Shift value 3: T H I S
        - Plaintext: THIS (with shift value 3)
    - What is shift value for the ciphertext "WHVW". (Cryptanalysis example)
        - Ciphertext: W H V W
            - Shift value 1: V G U V
            - Shift value 2: U F T U
            - Shift value 3: T E S T
        - Shift value is 3 for plaintext "TEST"
    - What is shift value for the ciphertext "GCUA VQ DTGCM". (Cryptanalysis example)
        - Ciphertext: GCUA VQ DTGCM
            - Shift value 1: FBTZ UP CSFBL
            - Shift value 2: EASY TO BREAK
        - Shift value is 2 for plaintext "EASY TO BREAK"

### Cryptanalysis of Caesar CIpher
- only 26 possibble ciphers
- could simply try each in turn
- brute force attack or exhaustive search
- given ciphertext, just try to shift all letters
- more secure than simple substitution cipher


### Mono Alphabetic Substitution Cipher
- Rather than just shifting the alphabets, it shuffles the letters randomly.
- each plaintext letter maps to a different random ciphertext letter.
- number of possible keys = 26! = 4 x 10^26 -> more secure than caesar cipher

Language Redundancy and Cryptanalysis
- human languages have redundancy
- example: "th lrd s m shphrd shll nt wnt" -> "the lord is my shepherd shall not want"
- letters are not equally commonly used
- in english, e is most common letter, followed by t, a, o, i, n, s, h, r
- other letters are fairly rare: z, q, x, j

|Frequency Analysis of English Language| Letters and Bigrams|
|---|---|
|Most Frequent Letters in English| E T A O I N S H R D L U|
|Most Frequent Bigrams| th he in er an re nd at on nt ha es st en of te ed is it al ar ti to|
|---|---|


Use in crypanalysis:
- mono alphabetic substitution ciphers do not change relative ketter frequencies
- calculate letter frequencies in ciphertext
- compare with known letter frequencies in language
- ...

### Substitution Cipher: Polygram
- it involes group of characters being substituted by another group of characters.
- the character group can be digram (2 letters), trigram (3 letters) or ngrams (n letters).
- For digram substitution, there are many possible keys for 26 characters:
    - number of possible digrams = 26 x 26 = 676
    - number of possible keys = 676! = 4.3 x 10^1551
- Playfair cipher is a popular example of polygram substitution cipher.

#### Playfair Cipher
- 5 x 5 matrix of letters for word CRYPTOGRAPHY
    ```
    C R Y P T
    O G A H B
    D E F I K
    L M N Q S
    U V W X Z
    ```
- Make a table using a keyword (remove duplicates) followed by remaining letters of the alphabet.
- For letters 'I' and 'J', either combine them into one cell or omit 'J' from the alphabet.
- If the plaintext has an odd number of letters, add an 'Z' or 'X' or 'Y' or 'Q' at the end to make it even.
- 4 rules to encrypt a pair of letters:
    - if letters of a pair are same then add an 'X' and encrypt the new pair.
        - e.g., HELLO -> HE LX LO
    - if letters appear on the same row, replace them with the letters to their immediate right with wrapping (according to the direction).
        - e.g., RY -> YP, RT -> YC (wraps around), TC -> CR
    - if letters appear on the same column, replace them with the letters immediately below with wrapping (according to the direction).
        - e.g., AF -> FN, YN -> AW, YW -> AY, NF -> FA
    - if letters are not on the same row or the column, replace them with letters on the same row respectively but at the other pair of corners of the rectangle defined by the original pair.
        - e.g., FS -> KN, AM -> GN, GQ -> HM, RZ -> TV

### Cryptanalysis of Playfair cipher
- more secure than monoalphabetic substitution cipher
- the digram possibilities are 26 x 26 = 676

Identifiation: 
- cipher message contains an even number of letters
- only 25 letters used (I/J combined or J omitted)

Attack methods:
- goal: recover 5 x 5 matrix -> general structure is known
- known plaintext: probable words lead to partial decryption
- digram frequency count:
    - common digrams: th, he, in, er, an, re, nd, at, on, nt
    - rare digrams: qx, jq, zx, qz, jz


Example: 
- Key: cryptography class spring
- Plaintext: hello find the solution

    Matrix:

        c r y p t
        o g a h l
        s i n b d
        e f k m q
        u v w x z

- Plaintext pairs: he lx lo fi nd th es ol ut io nz
- Ciphertext pairs: om hz og ig bs pl so go zc sg dw
    
    for ha, both the encrypted pairs lh/ag correct. consider the encryption according to the direction of the plaintext

Example: 
- Key: keyword
- Plaintext1: why dont you
- Plaintext2: come to the window
- Plaintext3: the big wheel

Matrix:

    k e y w o
    r d a b c
    f g h i l
    m n p q s
    t u v x z

- Plaintext1 pairs: wh yd on ty ou
- Ciphertext1 pairs: yi ea es vk ez

- Plaintext2 pairs: co me to th ew in do wz
- Ciphertext2 pairs: oz nk zk vf yp gq ce ox

- Plaintext3 pairs: th eb ig wh ex el
- Ciphertext3 pairs: vf wd lh yi wu og

Example:
- Key: monarchy
- Plaintext: i am at college right now

Matrix:

    m o n a r
    c h y b d
    e f g i k
    l p q s t
    u v w x z

- Plaintext pairs: ia ma tc ol le ge ri gh tn ow
- Ciphertext pairs: bx or ld mp ec if ak fy qr nv

#### Changes to Playfair Cipher
- For row, we can go based on direction of plaintext instead of always going right. (both are correct though)

### Polyalphabetic Substitution Cipher
- number of shifts change per letter in the word
- key will be a word or phrase
- multiple ceaser ciphers in rotation
- make sure that length of key is equal to the length of plaintext
    - by matching or repeating the key
        - key = "xyz" plaintext = "abcdef" -> key = "xyzxyz"
    - autokey method: use part of plaintext as key
        - key = "xyz" plaintext = "abcdef" -> key = "xyzabc"
- this is another approach to improve security by using multiple cipher alphabets which is called as polyalphabetic substitution cipher.
- it repeats the key form the beginning if the key is shorter than the plaintext.
1. Vigenere Cipher:
- the simplest polyalphabetic substituion cipher
- effectively multiple caesar ciphers
- the key is multiple letters long k = k1 k2 k3 ... kn
- decryption in vigenere cipher simply works in reverse
- ith place of ciphertext C is obtained by shifting ith place of plaintext P by ki places.
    - C[i] = E(P[i]) = P[i] + K[i] mod 26
    - P[i] = D(C[i]) = C[i] - K[i] mod 26
- the same plaintext character is encrypted to different ciphertext character
- example:
    key = "cat"
    plaintext = "college"

    extended key = "catcatc" (c: 2, a:0, t:19)
    ciphertext = "eoenezg"
    C: 2 + 2 = 4 mod 26 -> E
    O: 14 + 0 = 14 mod 26 -> O
    L: 11 + 19 = 30 mod 26 -> 4 -> E

    - key = "deceptive"
    plaintext = "we are discovered, save yourself"
    extended key = "deceptivedeceptivede"

```
    d + w = z
    e + e = i

    c + a = c
    e + r = v
    p + e = t

    t + d = w
    i + i = q
    v + s = n
    e + c = g
    d + o = r /
    e + v = z
    c + e = g
    e + r = v
    p + e = t
    t + d = w

    i + s = a
    v + a = v
    e + v = z
    d + e = h

    e + y = c
    c + o = q
    t + u = n y
    i + r = z g
    v + s = n l 
    e + e = i m 
    d + l = o g 
    e + f = j
```
    ciphertext = "zicvtwqngrzgvtwavz h cq nznioj"
    in the ppt dw (this is wrong)

Security of Vigenere Cipher
- if a vigenere cipher is suspected then determine the length of the key word
- if two identical sequences of plaintext letters occur at a distance that is an integer multiple of the key length, which generates identical ciphertext sequences.
here e + r is separated by 9 letters.
- attacker & sender perspective


### Autokey System
- to find a solution against the known frequency characteristic using the repeated key, another approach called autokey system can be used.
- in autokey system, a key word is concatenated with the plaintext to provide a running key.
- vulnerable to cryptanalysis

### Vernam Cipher
- second type of playfair cipher aka one time pad
    XOR Table
    | A | B | A XOR B |
    |---|---|---------|
    | 0 | 0 |    0    |
    | 0 | 1 |    1    |
    | 1 | 0 |    1    |
    | 1 | 1 |    0    |
- Ci = Pi XOR Ki
    - Ci = ith character of ciphertext
    - Pi = ith character of plaintext
    - Ki = ith character of key
- Important ASCII Values:
    - A - Z : 65 - 90
    - a - z : 97 - 122
    - 0 - 9 : 48 - 57

- Question 1:

    Plaintext: ABC
    - 65 = 01000001
    - 66 = 01000010
    - 67 = 01000011 

    Key: XYZ
    - 88 = 01011000
    - 89 = 01011001
    - 90 = 01011010

    Ciphertext:
    - C1 = P1 XOR K1 = 01000001 XOR 01011000 = 00011001 = 25
    - C2 = P2 XOR K2 = 01000010 XOR 01011001 = 00011011 = 27
    - C3 = P3 XOR K3 = 01000011 XOR 01011010 = 00011001 = 24

- Question 2:

    Plaintext: CAT
    - 67 = 01000011
    - 65 = 01000001
    - 84 = 01010100
    
    Key: AAA
    - 65 = 01000001
    - 65 = 01000001
    - 65 = 01000001

    Ciphertext:
    - C1 = P1 XOR K1 = 01000011 XOR 01000001 = 00000010 = 2
    - C2 = P2 XOR K2 = 01000001 XOR 01000001 = 00000000 = 0
    - C3 = P3 XOR K3 = 01010100 XOR 01000001 = 00010101 = 21

- Key length must be equal to plaintext length
- key must be purely random (natural: taken from nature -> pure random (psuedo random: when computer generates the key))
- In theory, vernam cipher is 100% secure 
- Pure random keys cant be generated by computer
- Transfer of key: key must get to receiver - mammonth key distribution problem. when encoding large data, the key must be large too -> not practical

Substitution Cipher Types Summary:
1. Monoalphabetic Substitution Cipher: Classical Caesar Cipher, Simple Monoalphabetic Substitution Cipher
mono - classical ceaser, simple monoalphabetic
polgygram - playphar and bill
polyalphabetic - vigenere and vernam

## Transposition Cipher
- aka classical transposition or permutation cipher
- it rearranges the positions of characters in the plaintext.
- can recognise these since have the same frequency distribution as the plaintext.
- Types: 
1. Rail Fence Cipher:
- it writes the plaintext in a zigzag pattern on an imaginary fence, then reads off each row to create the ciphertext.
    - Example:
        - Plaintext: "meet me after the toga party"
        - Key: 2
        - Zigzag pattern:
            ```
            m  e  m  a  t  r  h  t  g  p  r  y
              e  t  e  f  e  t  e  o  a  a  t
            ```
        - Ciphertext: "mematrhtgpryetefeteoaat"

    - Decryption:
        - Determine the number of rows based on the key.
        - Calculate the number of characters in each row.
        - Fill in the zigzag pattern row by row using the ciphertext.
        - Read off the characters in a zigzag manner to reconstruct the plaintext.