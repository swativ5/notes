# Number Theory

- Number theory is a also called as **higher arithmetic** consisting of the study of the propertioes of whole numbers.
- Primes and prime factorization are important concepts in number theory.
- Cryptography is the process of transferring information securely, in a way that no unwanted third party will be able to undertand the message.
- Number theory and cryptography are closely related.

### Basics
- Z is the set of all integers {..., -3, -2, -1, 0, 1, 2, 3, ...}
Let a, b, c ∈ Z, then a + b ∈ Z, a - b ∈ Z, a * b ∈ Z
It satisfies the closure property for set Z.

- Commutative Property:
    - a + b = b + a
    - a * b = b * a
- Associative Property:
    - (a + b) + c = a + (b + c)
    - (a * b) * c = a * (b * c)
- Distributive Property:
    - a * (b + c) = a * b + a * c
    - (a + b) * c = a * c + b * c
- Identity Elements:
    - a + 0 = a
    - a * 1 = a

- Division:
    - a | b means a divides b [a is divisor and b is dividend]
    - a |` b means a does not divide b
    - if c | a and c | b, c is the common divisor of a and b.

- Prime Numbers:
    - A prime number is a natural number greater than 1 that cannot be formed by multiplying two smaller natural numbers.
    - It is the building bloacks of all numbers because of the Fundamental Theorem of Arithmetic, which states that every positive integer is uniquely  product of prime numbers. 

- GCD
    - gcd(a, b) is the greatest common divisor of a and b.
    - we can perform multiplicative inverse if gcd(a, m) = 1    
    - Examples
        - gcd(36, 24) = 12
            - 36 = 2^2 * 3^2
            - 24 = 2^3 * 3^1
            - gcd(36, 24) = 2^min(2, 3) * 3^min(2, 1) = 2^2 * 3^1 = 12
        - gcd(17, 13) = 1
        - gcd(24598, 7895) = 1
    - Euclidean Algorithm
        - Division Theorem: dividend = quotient * divisor + remainder
        - Used to compute gcd of two numbers.
        - Based on the principle that gcd(a, b) = gcd(b, a mod b)
        - Steps:
            1. Divide a by b, get the remainder r.
            2. Replace a with b and b with r.
            3. Repeat until r = 0. The non-zero remainder is the gcd.
        - Example:
            - gcd(48, 18)
                - 48 mod 18 = 12
                - 18 mod 12 = 6
                - 12 mod 6 = 0
                - gcd(48, 18) = 6
        - gcd(96, 30)
                - 96 mod 30 = 6
                - 30 mod 6 = 0
                - gcd(96, 30) = 6

- Residual Class
    - [0]12 = {..., -24, -12, 0, 12, 24, ...}
    - [1]12 = {..., -23, -11, 1, 13, 25, ...}
        - x = 12k + 1 where k ∈ Z
    - A residual class, also known as a congruence class, is a set of integers that are equivalent to each other modulo n, where n is a positive integer(called modulus).

- Modular Arithmetic Operations
    - |(a mod n) + (b mod n)|mod n = (a + b) mod n
    - |(a mod n) - (b mod n)|mod n = (a - b) mod n
    - |(a mod n) * (b mod n)|mod n = (a * b) mod n
    - useful when numbers are very big 
    - Example 1:
        - |(11 mod 8) + (15 mod 8)|mod 8 = (11 + 15) mod 8
            - = |3 + 7|mod 8 = 26 mod 8
            - = 10 mod 8 = 26 mod 8
            - = 2 = 2
        - |(11 mod 8) - (15 mod 8)|mod 8 = (11 - 15) mod 8
            - = |3 - 7|mod 8 = -4 mod 8
            - = 4 mod 8 = -4 mod 8
            - = 4 = 4
        - |(11 mod 8) * (15 mod 8)|mod 8 = (11 * 15) mod 8
            - = |3 * 7|mod 8 = 165 mod 8
            - = 21 mod 8 = 165 mod 8
            - = 5 = 5
    - Example 2:
        - (35 + 46) mod 7 = |(35 mod 7) + (46 mod 7)|mod 7 = |0 + 4| mod 7 = 4 mod 7 = 4
        - (35 - 46) mod 7 = |0 - 4| mod 7 = -4 mod 7 = 3
        - (35 * 46) mod 7 = |0 * 4| mod 7 = 0 mod 7 = 0
    - Negative mod n
        - To compute a negative mod n, we can add n until we get a non-negative result.
        - Example:
            - -3 mod 5
                - = -3 + 5 = 2
            - -8 mod 6
                - = -8 + 6 = -2
                - = -2 + 6 = 4

- Addition modulo m table (a + b) mod m = x
    - Z = {....-1, 0, 1, 2,...}
    - Zm - {0, 1, 2, ..., m-1}
    - m = 7
        | + mod 7 | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
        |---|---|---|---|---|---|---|---|
        | 0 | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
        | 1 | 1 | 2 | 3 | 4 | 5 | 6 | 0 |
        | 2 | 2 | 3 | 4 | 5 | 6 | 0 | 1 |
        | 3 | 3 | 4 | 5 | 6 | 0 | 1 | 2 |
        | 4 | 4 | 5 | 6 | 0 | 1 | 2 | 3 |
        | 5 | 5 | 6 | 0 | 1 | 2 | 3 | 4 |
        | 6 | 6 | 0 | 1 | 2 | 3 | 4 | 5 |
    - Number is not repeated in any row or column.
    - Table is symmetric along the main diagonal.

- Multiplication modulo m table (a * b) mod m = x
    - m = 7
        | * mod 7 | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
        |---|---|---|---|---|---|---|---|
        | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
        | 1 | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
        | 2 | 0 | 2 | 4 | 6 | 1 | 3 | 5 |
        | 3 | 0 | 3 | 6 | 2 | 5 | 1 | 4 |
        | 4 | 0 | 4 | 1 | 5 | 2 | 6 | 3 |
        | 5 | 0 | 5 | 3 | 1 | 6 | 4 | 2 |
        | 6 | 0 | 6 | 5 | 4 | 3 | 2 | 1 |
    - Number is not repeated in any row or column except for the first row and first column.
    - Table is symmetric along the main diagonal.

- Division modulo m or Division in Zm
    - a / b mod m = a * b^(-1) mod m

- Inverses
    1. Additive Inverse
        - *a mod m is the additive inverse of +a mod m
        - *-a + a mod m ≡ 0
        - For every a ∈ Zm, there exists an element b ∈ Zm such that a + b ≡ 0 mod m
        - b is called the additive inverse of a mod m.
        - Example:
            - m = 7
            - a = 3
            - b = 4
            - 3 + 4 ≡ 0 mod 7
    2. Multiplicative Inverse
        - *1 / a mod m is the multiplicative inverse of a mod m
        - *Identity element of multiplication is 1
        - *a * a^(-1) mod m ≡ 1
        - For every a ∈ Zm, there exists an element b ∈ Zm  such that a * b ≡ 1 mod m
        - b is called the multiplicative inverse of a mod m.

- Multiplicative Inverse mod n
    - a^-1 mod n is the multiplicative inverse of a mod n if
        - gcd(a, n) = 1
        - a * a^-1 mod n ≡ 1
    - Example:
        - 2^-1 mod 7 = 4
            - gcd(2, 7) = 1
            - 2 * 4 mod 7 = 8 mod 7 = 1
            - 4 is the multiplicative inverse of 2 mod 7
            - 2 is the multiplicative inverse of 4 mod 7
        - 6^-1 mod 7 = 6
            - gcd(6, 7) = 1
            - 6 * 6 mod 7 = 36 mod 7 = 1
            - 6 is the multiplicative inverse of 6 mod 7
        - 1^-1 mod 7 = 1
            - gcd(1, 7) = 1
            - 1 * 1 mod 7 = 1
            - 1 is the multiplicative inverse of 1 mod 7
    - Why?
        - Encryption: c = p * k mod 26 where c is the ciphertext, p is the plaintext, and k is the key.
        - Decryption: p = c * k^-1 mod 26 where k^-1 is the multiplicative inverse of k mod 26.
    - Table
        |a mod 7| 1 | 2 | 3 | 4 | 5 | 6 |
        |---|---|---|---|---|---|---|
        |a^-1 mod 7| 1 | 4 | 5 | 2 | 3 | 6 |

- Finding Multiplicative Inverse using Extended Euclidean Algorithm
    - To find the multiplicative inverse of a mod m, we can use the Extended Euclidean Algorithm to find integers x and y such that:
        - a * x + m * y = gcd(a, m)
    - If gcd(a, m) = 1, then x is the multiplicative inverse of a mod m.
    - Example: 356 mod 45
        |q| a |m | r | x | y |
        |---|---|---|---|---|---|
        | - |356| 45| 41| 1 | 0 |
        | 7 | 45| 41| 4 | 0 | 1|
        | 1 | 41| 4 | 1 | 1 | -7|
        | 4 | 4 | 1 | 0 | -1| 8 |
        | 4 | 1 | 0 |   |   |   |
        - gcd(356, 45) = 1
        - 356 * (-1) + 45 * 8 = 1   
        - -1 is the multiplicative inverse of 356 mod 45
        - To make it positive, we can add 45 to -1
        - -1 + 45 = 44
        - Therefore, the multiplicative inverse of 356 mod 45 is 44.

Question:
- find the multiplicative inverse of 356 mod 45
    - a is 356
    - m is 45
    - u = u0 - (u1 * q)
        |q | a | m | r | u0 | u1 | u|
        |--|-- |--|--|--|--|---|
        |7 |356| 45| 41| 1 | 0 | 1 |
        |1 |45 | 41| 4 | 0 | 1 | -1|
        |10|41 | 4 | 1 | 1 | -1| 11|
        |4 |4  | 1 | 0 | -1| 11| -44|
        
    - gcd(356, 45) = 1 = m when r = 0
    - u1 = 11 
    - therefore, the multiplicative inverse of 356 mod 45 is 11

- Congruence class:
    - a congruence class or residual class is a set of integers that are equivalent to each other modulo n, where n is a positive integer (called modulus).
    - a ≡ b mod n 
        - (a - b) mod n = 0
        - a mod n = b mod n
            - both a and b leave the same remainder when divided by n
    - 12 ≡ 18 (mod 15)
        - 12 mod 15 = 12
        - 18 mod 15 = 3
        - 12 mod 15 ≠ 18 mod 15 -> invalid
    - -3 ≡ -18 (mod 15)
        - (-3 - -18) mod 15 = 0
        - -3 mod 15 = 12
        - -18 mod 15 = 12
        - -3 mod 15 = -18 mod 15 -> valid
    - 12 ≡ -3 (mod 15)
        - (12 - -3) mod 15 = 0
        - 12 mod 15 = 12
        - -3 mod 15 = 12
        - 12 mod 15 = -3 mod 15 -> valid
    - 7 ≡ 19 (mod 11)
        - (7 - 19) mod 11 = -12 mod 11 = -1 mod 11 = 10 ≠ 0
        - 7 mod 11 = 7
        - 19 mod 11 = 8
        - 7 mod 11 ≠ 19 mod 11 -> invalid
    - 4 ≡ -19 (mod 11)
        - (4 - -19) mod 11 = (23 ) mod 11 = 1 ≠ 0
        - 4 mod 11 = 4
        - -19 mod 11 = -8 mod 11 = 3
        - 4 mod 11 ≠ -19 mod 11 -> invalid
    - 4 ≡ -18 (mod 11)
        - (4 - -18) mod 11 = 22 mod 11 = 0
        - 4 mod 11 = 4
        - -18 mod 11 = 4
        - 4 mod 11 = -18 mod 11 -> valid
    - 4^-1 ≡ 2 (mod 7)
        - (1/4) ≡ 2 (mod 7)
        - 4 * (1/4) ≡ 4 * 2 (mod 7)
        - 1 ≡ 8 (mod 7)
            - 8 mod 7 = 1
            - 1 mod 7 = 1
            - 1 mod 7 = 8 mod 7 -> valid
        - 4 * 2 mod 7 = 8 mod 7 = 1
        - therefore, 2 is the multiplicative inverse of 4 mod 7

- Check if multiplicative inverse exists
    - if gcd(a, m) = 1, then multiplicative inverse exists
    - if gcd(a, m) ≠ 1, then multiplicative inverse does not exist
    - Example:
        - 2^-1 mod 10
            - gcd(2, 10) = 2 ≠ 1
            - therefore, multiplicative inverse does not exist
        - 2^-1 mod 11
            - gcd(2, 11) = 1
            - therefore, multiplicative inverse exists
        - 3^-1 mod 10
            - gcd(3, 10) = 1
            - therefore, multiplicative inverse exists
    
- Find the multiplicative inverse of:
    - 9 mod 10
        - gcd(9, 10) = 1
        - therefore, multiplicative inverse exists
        - using extended euclidean algorithm
            |q | a | m | r | u0 | u1 | u|
            |--|-- |--|--|--|--|---|
            |1 |10 | 9 | 1 | 1 | 0 | 1 |
            |9 |9  | 1 | 0 | 0 | 1 | -1|
    - Find multiplicative inverse of 23 in Z100
        - gcd(23, 100) = 1
        - therefore, multiplicative inverse exists
        - using extended euclidean algorithm
            |q | a | m | r | u0 | u1 | u|
            |--|-- |--|--|--|--|---|
            |4 |100| 23| 8 | 1 | 0 | 1 |
            |2 |23 | 8 | 7 | 0 | 1 | -4|
            |1 |8  | 7 | 1 | 1 | -4| 9 |
            |7 |7  | 1 | 0 | -4| 9 | -67|
        - therefore, the multiplicative inverse of 23 mod 100 is 9